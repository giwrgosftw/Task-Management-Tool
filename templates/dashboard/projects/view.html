{% extends "dashboard/base.html" %}
{% block content %}
    <div id="layoutSidenav">
        <div id="layoutSidenav_content">
            <form method="POST">
                <div class="card-header">
                    <h4> Project ID: {{project._id}} </h4>
                </div>
                <div class="card-body">
                    <label>Title</label>
                    <input value="{{project.title}}" id='title' name="title" class="form-control"/>

                    <label style=margin-top:30px;>Description</label>
                    <input value="{{project.description}}" id='description' name="description" class="form-control"/>

                    <label style=margin-top:30px;>Deadline</label>
                    <input style=width:19%; type="date" value="{{project.date}}" id='date' name="date" class="form-control"/>

                    <button style=margin-top:12px; type="submit" class="btn btn-primary" formaction="{{ url_for('update_project', project_id=project._id) }}" >Update </button>
                    <button style=margin-top:12px; type="submit" class="btn btn-danger" formaction="{{ url_for('delete_project', project_id=project._id) }}"> Delete </button>
                </div>
            </form>


            <form method="POST">
                    <!-- https://datatables.net/examples/api/form.html -->
                    <div class="card-body">
                    <div class="table-responsive">
                        <a href="{{ '/dashboard/projects/%s'%project["_id"] + '/new_task' }}" style=margin-bottom:12px; class="btn btn-success" role="button">Add Task</a>
                        <table class="table table-bordered" width="100%" cellspacing="0">
                            <thead>
                            <tr>
                                <th>Task</th>
                                <th>Small Description</th>
                                <th>Deadline</th>
                                <th>Assigned to</th>
                                <th>Edit</th>
                                <th>Delete</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for task in tasks %}
                                {% if task["project_id"] == project._id%} <!-- we want to display only the tasks which belong to the specific id -->
                                    {% if task["title"] != ""%} <!-- we also want to hide the auto-created empty task -->
                                        <tr>
                                            <td> <a href="{{ '/dashboard/projects/%s'%project["_id"] + '/%s'%task["_id"] }}"> {{task["title"]}} </a> </td>
                                            <td>{{task["description"]}}</td>
                                            <td>{{task["date"]}}</td>
                                            <td>{{task["assign_to"]}}</td>
                                            <td class="text-center"><a href="{{ '/dashboard/projects/%s'%project["_id"] + '/%s'%task["_id"] }}" class="btn btn-primary" style=height:35px; role="button">Edit</a></td>
                                            <td class="text-center"><button type="submit" class="btn btn-danger" style=height:35px; formaction="{{ url_for('delete_task', project_id=project._id, task_id=task._id) }}"> Delete </button></td>
                                        </tr>
                                    {% endif %}
                                {% endif %}
                            {% endfor %}
                            </tbody>
                            <tfoot>
                            <tr>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                            </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </form>

        </div>
    </div>
{% endblock %}